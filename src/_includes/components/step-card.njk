<div class="step-ticket {{ 'step-ticket--next' if isNext else 'step-ticket--waiting' }}"
     data-step-id="{{ step.id }}"
     data-start-minute="{{ step.startMinute }}"
     data-duration-minutes="{{ step.durationMinutes | default(0) }}">

  {# Ticket Header with order number, resource, and time #}
  <div class="step-ticket-header">
    <span class="step-number">#{{ loop.index | default(1) }}</span>
    {% if step.resource %}
    <span class="step-resource">{{ step.resource | upper }}</span>
    {% endif %}
    <span class="step-countdown-badge">
      <span class="step-time text-mono">T-{{ step.startMinute | formatMinutes }}</span>
      <span class="step-countdown hidden">--:--</span>
    </span>
  </div>

  {# Step Image if available #}
  {% if step.image %}
  <img
    src="{{ step.image }}"
    alt="Step: {{ step.instruction | truncate(50) }}"
    class="step-image"
    loading="lazy"
  />
  {% endif %}

  {# Ticket Body with instruction #}
  <div class="step-ticket-body">
    {% if isNext %}
    <span class="badge badge--fire badge--stamp mb-2">Next</span>
    {% endif %}

    <p class="step-instruction">{{ step.instruction }}</p>

    {% if step.durationMinutes %}
    <p class="step-duration">
      Duration: {{ step.durationMinutes | formatMinutes }}
    </p>
    {% endif %}
  </div>
</div>
