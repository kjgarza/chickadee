---
pagination:
  data: recipes
  size: 1
  alias: slug
permalink: "/recipes/{{ slug }}/"
layout: layouts/base.njk
title: "{{ recipes[slug].title }} | Cooking Timer"
ogTitle: "{{ recipes[slug].title }}"
ogDescription: "{{ recipes[slug].description | default('Cook ' + recipes[slug].title + ' with step-by-step guidance') }}"
eleventyComputed:
  ogImage: "/assets/images/og/{{ slug }}.png"
ogType: "article"
---
{% import "macros/recipe-macros.njk" as macros %}

{% set recipe = recipes[slug] %}
{% set process = processes[slug] %}

<div class="mb-6">
  <a href="{{ '/' | url }}" class="btn btn--ghost btn--sm">Back</a>
</div>

{# Recipe Header Section - collapsible when timer runs #}
<div id="recipe-header-section" class="mb-6">
  <h1>{{ recipe.title }}</h1>

  {% if recipe.description %}
  <p class="text-muted mb-4">{{ recipe.description }}</p>
  {% endif %}

  <div class="flex flex-wrap gap-2 mb-6">
    {% if recipe.difficulty %}
    <span class="badge badge--solid">
      {{ recipe.difficulty | upper }}
    </span>
    {% endif %}

    {% if process.totalDurationMinutes %}
    <span class="badge badge--ghost">{{ process.totalDurationMinutes | formatMinutes }}</span>
    {% endif %}
  </div>
</div>

{# Timer Controls #}
{% include "components/timer-controls.njk" %}

{# Serving Selector #}
<div id="serving-section">
{% set servings = recipe.servings %}
{% include "components/serving-selector.njk" %}
</div>

{# Ingredients Section #}
<div id="ingredients-section" class="ingredients-panel">
  <div class="ingredients-header">Prep List</div>
  <div class="ingredients-body">
    {{ macros.ingredientList(recipe.ingredients, recipe.servings.default) }}
  </div>
</div>

{# Timeline Section #}
{% if process and process.timeline %}
{% set timeline = process.timeline %}
{% include "components/timeline-view.njk" %}
{% endif %}

{# Finish Criteria #}
{% if process.finishCriteria %}
<div class="notice notice--success mt-6">
  <p class="notice-title">Done When</p>
  <p>{{ process.finishCriteria }}</p>
</div>
{% endif %}

<script>
  // Initialize recipe data and timer
  document.addEventListener('DOMContentLoaded', function() {
    const recipeData = {{ recipe | json | safe }};
    const processData = {{ process | json | safe }};

    initRecipeData(recipeData);
    initTimeline(processData);
    initTimer('{{ slug }}');
  });
</script>
