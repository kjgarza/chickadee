---
layout: layouts/base.njk
title: Recipes
---

<h1>Select Order</h1>

{# Collect all unique tags #}
{% set allTags = [] %}
{% for slug, recipe in recipes %}
  {% if recipe.tags %}
    {% for tag in recipe.tags %}
      {% if tag not in allTags %}
        {% set allTags = (allTags.push(tag), allTags) %}
      {% endif %}
    {% endfor %}
  {% endif %}
{% endfor %}

{# Tag Filter #}
<div class="filter-group">
  <p class="filter-label">Filter</p>
  <div class="filter-buttons">
    <button class="filter-btn filter-btn--active" data-tag="all" onclick="filterByTag('all')">
      All
    </button>
    {% for tag in allTags %}
    <button class="filter-btn {% if loop.index > 10 %}hidden-tag{% endif %}" data-tag="{{ tag }}" onclick="filterByTag('{{ tag }}')">
      {{ tag }}
    </button>
    {% endfor %}
    {% if allTags.length > 10 %}
    <button class="filter-btn filter-btn--expand" onclick="toggleExpandTags(true)">
      ...
    </button>
    <button class="filter-btn filter-btn--collapse" onclick="toggleExpandTags(false)">
      Less
    </button>
    {% endif %}
  </div>
</div>

<div id="recipe-grid">
  {% for slug, recipe in recipes %}
  <a href="{{ ('/recipes/' + slug + '/') | url }}" class="recipe-stub recipe-card" data-tags="{{ recipe.tags | join(',') if recipe.tags else '' }}">
    <div class="recipe-stub-header">
      <span>Order #{{ loop.index }}</span>
      {% if recipe.difficulty %}
      <span class="difficulty-dots">
        <span class="difficulty-dot {{ 'difficulty-dot--filled' if recipe.difficulty in ['easy', 'medium', 'hard'] }}"></span>
        <span class="difficulty-dot {{ 'difficulty-dot--filled' if recipe.difficulty in ['medium', 'hard'] }}"></span>
        <span class="difficulty-dot {{ 'difficulty-dot--filled' if recipe.difficulty == 'hard' }}"></span>
      </span>
      {% endif %}
    </div>
    <div class="recipe-stub-body">
      <h2 class="recipe-stub-title">{{ recipe.title }}</h2>
      {% if recipe.description %}
      <p class="recipe-stub-description">{{ recipe.description }}</p>
      {% endif %}

      <div class="recipe-stub-meta">
        {% if recipe.totalTimeMinutes %}
        <span>{{ recipe.totalTimeMinutes | formatMinutes }}</span>
        {% endif %}
        <span>{{ recipe.servings.min }}-{{ recipe.servings.max }} Covers</span>
      </div>

      {% if recipe.tags %}
      <div class="flex flex-wrap gap-2 mt-4">
        {% for tag in recipe.tags %}
        <span class="badge badge--ghost">{{ tag }}</span>
        {% endfor %}
      </div>
      {% endif %}
    </div>
  </a>
  {% else %}
  <div class="notice">
    <p class="notice-title">No Orders</p>
    <p>No recipes found. Add recipe JSON files to the _data folder.</p>
  </div>
  {% endfor %}
</div>

<style>
.hidden-tag {
  display: none;
}
.filter-btn--collapse {
  display: none;
}
.filter-buttons.expanded .hidden-tag {
  display: inline-flex;
}
.filter-buttons.expanded .filter-btn--expand {
  display: none;
}
.filter-buttons.expanded .filter-btn--collapse {
  display: inline-flex;
}
</style>

<script>
function filterByTag(tag) {
  // Update button states
  document.querySelectorAll('.filter-btn').forEach(btn => {
    if (btn.dataset.tag === tag) {
      btn.classList.add('filter-btn--active');
    } else {
      btn.classList.remove('filter-btn--active');
    }
  });

  // Filter recipe cards
  document.querySelectorAll('.recipe-card').forEach(card => {
    const cardTags = card.dataset.tags ? card.dataset.tags.split(',') : [];

    if (tag === 'all' || cardTags.includes(tag)) {
      card.classList.remove('hidden');
    } else {
      card.classList.add('hidden');
    }
  });
}

function toggleExpandTags(expand) {
  const filterButtons = document.querySelector('.filter-buttons');
  if (expand) {
    filterButtons.classList.add('expanded');
  } else {
    filterButtons.classList.remove('expanded');
  }
}
</script>
